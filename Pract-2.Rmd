---
title: "Practi-2"
output: html_document
---

### Part 1.1 Create a normalized relational schema

In the design, we created 5 tables named Journal,Article,History,CopyRight and Author.


https://lucid.app/lucidchart/d0c79371-862e-4f7c-a26a-675d442d3669/edit?viewport_loc=-3168%2C1190%2C2406%2C1158%2C0_0&invitationId=inv_479f45f2-d4c9-4514-8249-fbaeed3fb174



### Part 1.2 Realize the Relational Schema in SQLite

First, we start loading library
```{r}
library(XML)
library(RSQLite)
```

Second, we set up the file and path.
```{r }
path <- "/Users/andrewt/Desktop/Practicum-2/"
fn <- "pubmed_sample.xml"
fpn = paste0(path, fn)
dbfn <- "pubmed.db"
dbfpn = paste0(path, dbfn)
```

Third, we make connection to dataBase. 
```{r, include=FALSE}
PADBcon <- dbConnect(RSQLite::SQLite(), dbfpn)

```


### Part 1.2 Create table

Because of foreign key in Table Journal and Author which would be used in table Article, Copyright and History, Table Journal and Author should be inserted first and then we creating following tables.

Drop tables Journal.
```{sql, connection = "PADBcon"}
drop table if exists Journal;
```
Create table Journal
```{sql, connection = "PADBcon"}
create table Journal (
  Journal_id integer,
  ISSN text,
  Volumn integer,
  Issue integer,
  Title text,
  ISOAbbreviation text,
  Year integer,
  Month Text
);
```

Drop tables Author.
```{sql, connection = "PADBcon"}
drop table if exists Author;
```
Create table Author
```{sql, connection = "PADBcon"}
create table Author (
  Author_id integer,
  LastName text,
  ForeName text,
  Initials text,
  Affiliation text
);
```


Drop tables article.
```{sql, connection = "PADBcon"}
drop table if exists Article;
```
Create article table
```{sql, connection = "PADBcon"}
create table Article (
  PMID integer,
  Journal_id integer,
  ArticleTitle text,
  Pagination text,
  Language text,
  primary key (PMID),
  foreign key (Journal_id) references Journal(Journal_id)
);
```

Drop tables History.
```{sql drop tables history, connection = "PADBcon"}
drop table if exists History;
```

Create history table
```{sql ,connection = "PADBcon"}
create table History (
  History_id integer,
  PMID integer,
  Day integer,
  Month integer,
  Status text,
  
  primary key (History_id),
  foreign key (PMID) references Article(PMID)
);
```

Drop tables copyright
```{sql, connection = "PADBcon"}
drop table if exists Copyright;
```

Create tables copyright
```{sql, connection = "PADBcon"}
create table copyright (
  Record_id integer,
  PMID integer,
  Author_id integer,
  primary key (Record_id),
  foreign key (PMID) references Article(PMID),
  foreign key (Author_id) references Author(Author_id)
);


```

